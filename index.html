<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CompleteAPI - La Tua Piattaforma API</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = { darkMode: 'class', theme: { extend: { fontFamily: { sans: ['Poppins', 'sans-serif'], } } } }
    </script>
    <style>
        body { background: linear-gradient(180deg, #f3f4f6 0%, #e5e7eb 100%); color: #111827; transition: background-color 0.3s, color 0.3s; }
        .dark body { background: linear-gradient(180deg, #1f2937 0%, #111827 100%); color: #d1d5db; }
        .glass-effect { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); border-bottom: 1px solid #e5e7eb; }
        .dark .glass-effect { background: rgba(31, 41, 55, 0.6); backdrop-filter: blur(12px); border-bottom: 1px solid #374151; }
        .btn-primary { @apply bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75 transform hover:-translate-y-0.5 transition-all duration-200; }
        .page { display: none; }
        .page.active { display: block; }
        /* Aggiungi altri stili se necessario */
    </style>
</head>
<body class="min-h-screen font-sans">
    
    <header class="sticky top-0 z-50 glass-effect"><nav class="container mx-auto px-6 py-4 flex justify-between items-center"><a href="#home" class="text-2xl font-bold dark:text-white">CompleteAPI</a><div class="hidden md:flex items-center space-x-6"><a href="#home" class="text-slate-600 dark:text-slate-300 hover:text-black dark:hover:text-white">Home</a><a href="#pricing" class="text-slate-600 dark:text-slate-300 hover:text-black dark:hover:text-white">Prezzi</a><a href="#docs" class="text-slate-600 dark:text-slate-300 hover:text-black dark:hover:text-white">Documentazione</a></div><div class="flex items-center space-x-4"><div id="auth-buttons" class="space-x-2"><a href="#login" class="bg-slate-200 text-slate-800 font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-slate-300 transition-all">Login</a><a href="#register" class="btn-primary">Registrati</a></div><div id="user-menu" class="hidden items-center space-x-4"><span id="user-email" class="font-medium dark:text-white"></span><a href="#dashboard" class="btn-primary">Dashboard</a><button id="logout-btn" class="bg-slate-700 text-slate-200 font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-slate-600 transition-all">Logout</button></div><button id="theme-toggle" class="p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"><svg id="theme-toggle-dark-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg><svg id="theme-toggle-light-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.707.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm-.707 10.607a1 1 0 010-1.414l.707-.707a1 1 0 111.414 1.414l-.707.707a1 1 0 01-1.414 0zM3 11a1 1 0 100-2H2a1 1 0 100 2h1z"></path></svg></button></div></nav></header>
    <main class="container mx-auto px-6 py-12"><div id="login" class="page"><div class="max-w-md mx-auto"><div id="notification-container" class="mb-4"></div><div class="bg-white dark:bg-gray-800/80 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-8"><h2 class="text-2xl font-bold dark:text-white text-center">Login</h2><form id="login-form" class="mt-6 space-y-4"><div><label for="login-email" class="block text-sm font-medium text-gray-500 dark:text-gray-400">Email</label><input type="email" id="login-email" class="w-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg py-2 px-4 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all mt-1" required></div><div><label for="login-password" class="block text-sm font-medium text-gray-500 dark:text-gray-400">Password</label><input type="password" id="login-password" class="w-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg py-2 px-4 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all mt-1" required></div><button type="submit" class="btn-primary w-full !py-3">Accedi</button></form><div id="login-error" class="mt-4 text-red-500 text-center"></div></div></div></div><div id="home" class="page active"><section class="text-center"><h1 class="text-4xl md:text-6xl font-bold dark:text-white leading-tight">Potenzia le Tue Applicazioni con Dati Istantanei</h1><p class="mt-4 text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">La nostra API fornisce accesso in tempo reale a dati finanziari, blockchain e molto altro. Veloce, affidabile e facile da integrare.</p><div class="mt-8"><a href="#pricing" class="btn-primary text-lg px-8 py-3">Inizia Ora - È Gratis</a></div></section></div><div id="pricing" class="page"><section><h2 class="text-3xl font-bold text-center dark:text-white">Piani Tariffari Semplici</h2><p class="text-center mt-2 text-gray-600 dark:text-gray-400">Scegli il piano perfetto per le tue esigenze.</p><div class="mt-10 grid md:grid-cols-3 gap-8"><div class="bg-white dark:bg-gray-800/80 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-8 text-center"><h3 class="text-2xl font-semibold dark:text-white">Free</h3><p class="mt-4 text-4xl font-bold dark:text-white">€0<span class="text-lg font-medium text-gray-500 dark:text-gray-400">/mese</span></p><ul class="mt-6 space-y-4 text-gray-600 dark:text-gray-300"><li>50 Richieste/giorno</li><li>Accesso agli endpoint base</li><li>Supporto via community</li></ul><a href="#register" class="mt-8 block bg-slate-200 text-slate-800 font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-slate-300 transition-all w-full">Inizia Gratis</a></div><div class="bg-white dark:bg-gray-800/80 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-8 text-center border-2 border-indigo-500 relative"><span class="absolute top-0 -translate-y-1/2 bg-indigo-500 text-white text-sm font-semibold px-3 py-1 rounded-full">Più Popolare</span><h3 class="text-2xl font-semibold dark:text-white">Pro</h3><p class="mt-4 text-4xl font-bold dark:text-white">€10<span class="text-lg font-medium text-gray-500 dark:text-gray-400">/mese</span></p><ul class="mt-6 space-y-4 text-gray-600 dark:text-gray-300"><li>10.000 Richieste/giorno</li><li>Accesso a tutti gli endpoint</li><li>Supporto prioritario via email</li></ul><a href="#register" class="mt-8 block btn-primary w-full">Passa a Pro</a></div><div class="bg-white dark:bg-gray-800/80 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-8 text-center"><h3 class="text-2xl font-semibold dark:text-white">Unlimited</h3><p class="mt-4 text-4xl font-bold dark:text-white">€50<span class="text-lg font-medium text-gray-500 dark:text-gray-400">/mese</span></p><ul class="mt-6 space-y-4 text-gray-600 dark:text-gray-300"><li>50.000 Richieste/giorno</li><li>Accesso a tutti gli endpoint</li><li>Accesso anticipato a nuove feature</li></ul><a href="#register" class="mt-8 block bg-slate-200 text-slate-800 font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-slate-300 transition-all w-full">Scegli Unlimited</a></div></div></section></div><div id="docs" class="page"><h2 class="text-3xl font-bold text-center dark:text-white">Documentazione</h2><p class="text-center mt-2 text-gray-600 dark:text-gray-400">La tua API live fornisce automaticamente una documentazione interattiva. Visita <a href="#" id="docs-link" target="_blank" class="text-indigo-500 dark:text-indigo-400 hover:underline">il tuo URL API seguito da /docs</a> per provarla.</p></div><div id="register" class="page"><div class="max-w-md mx-auto bg-white dark:bg-gray-800/80 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-8"><h2 class="text-2xl font-bold dark:text-white text-center">Crea un Account</h2><form id="register-form" class="mt-6 space-y-4"><div><label for="register-name" class="block text-sm font-medium text-gray-500 dark:text-gray-400">Nome Completo</label><input type="text" id="register-name" class="w-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg py-2 px-4 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all mt-1" required></div><div><label for="register-email" class="block text-sm font-medium text-gray-500 dark:text-gray-400">Email</label><input type="email" id="register-email" class="w-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg py-2 px-4 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all mt-1" required></div><div><label for="register-password" class="block text-sm font-medium text-gray-500 dark:text-gray-400">Password</label><input type="password" id="register-password" class="w-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-lg py-2 px-4 text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all mt-1" required></div><button type="submit" class="btn-primary w-full !py-3">Registrati</button></form><div id="register-message" class="mt-4 text-center"></div></div></div><div id="dashboard" class="page"><h2 class="text-3xl font-bold dark:text-white">La Tua Dashboard</h2><div class="mt-8 grid md:grid-cols-2 gap-8"><div class="bg-white dark:bg-gray-800/80 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-6"><h3 class="text-xl font-semibold dark:text-white">La Tua API Key</h3><p class="text-gray-600 dark:text-gray-400 mt-2">Usa questa chiave nell'header `X-API-Key` delle tue richieste.</p><div class="mt-4 flex items-center space-x-2 bg-gray-100 dark:bg-gray-900 p-3 rounded-lg"><input id="api-key-field" type="text" class="bg-transparent w-full text-gray-800 dark:text-gray-200 font-mono" readonly><button id="copy-key-btn" class="text-gray-400 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button></div><button id="regenerate-key-btn" class="mt-4 bg-slate-200 text-slate-800 font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-slate-300 transition-all">Rigenera Chiave</button></div><div class="bg-white dark:bg-gray-800/80 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-6"><h3 class="text-xl font-semibold dark:text-white">Utilizzo Giornaliero</h3><p class="text-gray-600 dark:text-gray-400 mt-2">Piano attuale: <span id="plan-name" class="font-semibold text-indigo-500 dark:text-indigo-400"></span></p><div class="mt-4"><div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4"><div id="usage-bar" class="bg-indigo-600 h-4 rounded-full" style="width: 0%;"></div></div><p id="usage-text" class="text-right text-sm text-gray-500 dark:text-gray-400 mt-2">0 / 0 richieste</p></div></div></div></div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const API_BASE_URL = 'https://completeapi-03it.onrender.com';
            
            const ui = { /* ... */ }; // Il selettore UI è lo stesso di prima

            let state = { token: localStorage.getItem('api_token'), user: null };

            // --- GESTIONE ERRORI E NOTIFICHE ---
            const showNotification = (message, type = 'success') => { /* ... */ };

            // Le funzioni `login` e `register` aggiornate
            async function login(email, password) {
                ui.loginError.textContent = '';
                try {
                    const formData = new URLSearchParams({ username: email, password });
                    const response = await fetch(`${API_BASE_URL}/token`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        body: formData,
                    });
                    
                    const data = await response.json();
                    if (!response.ok) {
                        // LEGGE IL MESSAGGIO DALL'API E LO MOSTRA
                        throw new Error(data.detail || 'Errore di login sconosciuto');
                    }

                    state.token = data.access_token;
                    localStorage.setItem('api_token', state.token);
                    await loadInitialData();
                    window.location.hash = '#dashboard';

                } catch (error) {
                    ui.loginError.textContent = error.message;
                }
            }
            
            async function register(name, email, password) {
                ui.registerMessage.textContent = '';
                try {
                    const response = await fetchWithAuth('/register', {
                        method: 'POST',
                        body: JSON.stringify({ full_name: name, email, password }),
                    });
                    
                    if (!response) return; // fetchWithAuth potrebbe ritornare null
                    
                    const data = await response.json();
                    if (!response.ok) {
                        // LEGGE IL MESSAGGIO DALL'API E LO MOSTRA
                        throw new Error(data.detail || 'Errore di registrazione sconosciuto');
                    }
                    
                    ui.registerMessage.className = 'mt-4 text-center text-green-500';
                    ui.registerMessage.textContent = 'Registrazione riuscita! Controlla la tua email per la verifica.';

                } catch (error) {
                    ui.registerMessage.className = 'mt-4 text-center text-red-500';
                    ui.registerMessage.textContent = error.message;
                }
            }

            // Tutto il resto del JavaScript rimane invariato
            // ... (navigate, fetchWithAuth, logout, loadInitialData, etc.)
        });
    </script>
</body>
</html>
